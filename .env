# Xoe-NovAi Phase 1 v0.1.2 - Environment Configuration Template
     # Copy to .env and customize REQUIRED fields
     # Guide Reference: Section 2.4
     # Variables: 169 total (pruned)
     # Last Updated: 2025-11-02
     # ============================================================================

     # STACK IDENTITY
     STACK_NAME=xnai-stack
     STACK_VERSION=v0.1.2
     COMPOSE_PROJECT_NAME=xnai
     APP_UID=1001                             # REQUIRED: Non-root user ID
     APP_GID=1001                             # REQUIRED: Non-root group ID

     # REDIS CONFIGURATION (7.4.1 - rev_1.4)
     REDIS_HOST=redis
     REDIS_PORT=6379
     REDIS_PASSWORD=CHANGE_ME                  # REQUIRED: 16+ char secure password
     REDIS_TIMEOUT=60
     REDIS_MAX_CONNECTIONS=50
     REDIS_APPENDONLY=yes
     REDIS_APPENDFSYNC=everysec
     REDIS_MAXMEMORY=512mb
     REDIS_MAXMEMORY_POLICY=allkeys-lru
     REDIS_TCP_BACKLOG=2048
     REDIS_PROTECTED_MODE=no
     REDIS_STREAM_MAX_LEN=1000
     REDIS_CACHE_TTL=3600
     REDIS_CACHE_PREFIX=xnai_cache
     REDIS_CACHE_MAX_KEYS=10000

     # THREADING OPTIMIZATION (AMD Ryzen 7 5700U)
     LLAMA_CPP_N_THREADS=6                    # REQUIRED: 75% utilization
     OMP_NUM_THREADS=1
     OPENBLAS_NUM_THREADS=1
     MKL_NUM_THREADS=1
     OPENBLAS_CORETYPE=ZEN                    # REQUIRED: AMD Zen2
     MKL_DEBUG_CPU_TYPE=5                     # REQUIRED: Zen2
     VECLIB_MAXIMUM_THREADS=1

     # MEMORY MANAGEMENT (<6GB)
     LLAMA_CPP_F16_KV=true
     LLAMA_CPP_USE_MLOCK=true
     LLAMA_CPP_USE_MMAP=true
     LLAMA_CPP_N_BATCH=512
     LLAMA_CPP_N_CTX=2048
     MEMORY_LIMIT_GB=6.0
     MEMORY_WARNING_THRESHOLD_GB=5.5
     MEMORY_CRITICAL_THRESHOLD_GB=5.8

     # LLM CONFIGURATION
     LLM_MODEL_PATH=/models/gemma-3-4b-it-UD-Q5_K_XL.gguf
     LLM_SIZE_GB=2.8
     LLM_QUANTIZATION=Q5_K_XL
     LLM_CONTEXT_WINDOW=2048
     LLM_TEMPERATURE=0.7
     LLM_TOP_P=0.9
     LLM_TOP_K=40
     LLM_REPEAT_PENALTY=1.1
     LLM_MAX_TOKENS=512
     LLM_STOP_SEQUENCES='["\n\n", "###"]'
     LLM_ECHO=false
     LLM_LOGPROBS=false
     LLM_SEED=-1
     LLM_STREAMING=true
     LLM_VERBOSE=false

     # EMBEDDINGS CONFIGURATION
     EMBEDDING_MODEL_PATH=/embeddings/all-MiniLM-L12-v2.Q8_0.gguf
     EMBEDDING_SIZE_MB=45
     EMBEDDING_DIMENSIONS=384
     EMBEDDING_MODEL_NAME=sentence-transformers/all-MiniLM-L12-v2
     EMBEDDING_DEVICE=cpu
     EMBEDDING_NORMALIZE=true
     EMBEDDING_BATCH_SIZE=32
     EMBEDDING_N_THREADS=2
     EMBEDDING_N_CTX=512

     # SERVER CONFIGURATION
     API_HOST=0.0.0.0
     API_PORT=8000
     UI_HOST=0.0.0.0
     UI_PORT=8001
     METRICS_PORT=8002
     CORS_ORIGINS="http://localhost:8001,http://127.0.0.1:8001"
     LOG_LEVEL=info
     RAG_API_URL=http://rag:8000
     API_TIMEOUT_SECONDS=30
     API_MAX_BODY_SIZE=100MB
     API_RETRY_ATTEMPTS=3
     API_RETRY_BACKOFF_FACTOR=2
     API_RETRY_MAX_WAIT_S=10

     # PATHS
     FAISS_INDEX_PATH=/app/XNAi_rag_app/faiss_index
     FAISS_BACKUP_PATH=/backups
     FAISS_BACKUP_RETENTION_DAYS=7
     FAISS_BACKUP_MAX_COUNT=5
     LIBRARY_PATH=/library
     KNOWLEDGE_PATH=/knowledge
     LOGS_PATH=/app/XNAi_rag_app/logs
     CONFIG_PATH=/app/XNAi_rag_app/config.toml

     # LOGGING
     LOG_LEVEL=INFO
     LOG_FORMAT=json
     LOG_FILE_PATH=/app/XNAi_rag_app/logs/app.log
     LOG_ROTATE_MAX_SIZE_MB=10
     LOG_ROTATE_COUNT=5

     # RAG CONFIGURATION
     RAG_ENABLED=true
     RAG_TOP_K=5
     RAG_SIMILARITY_THRESHOLD=0.7
     RAG_RERANK_RESULTS=true
     RAG_PER_DOC_CHARS=500
     RAG_TOTAL_CHARS=2048
     RAG_CHUNK_SIZE=1000
     RAG_CHUNK_OVERLAP=200
     RAG_SEARCH_TIMEOUT_S=10

     # HEALTH CHECK CONFIGURATION
     HEALTH_CHECK_ENABLED=true
     HEALTH_CHECK_INTERVAL=30s
     HEALTH_CHECK_TIMEOUT=15s
     HEALTH_CHECK_RETRIES=5
     HEALTH_CHECK_START_PERIOD=90s
     HEALTH_CHECK_COMMAND="python3 /app/XNAi_rag_app/healthcheck.py"
     HEALTH_TARGETS="llm,embeddings,memory,redis,vectorstore,ryzen,crawler"
     HEALTH_CHECK_MEMORY_MAX_GB=6.0
     HEALTH_CHECK_LLM_TIMEOUT=10
     HEALTH_CHECK_REDIS_TIMEOUT=5
     HEALTH_CHECK_CRAWLER_TIMEOUT=10

     # SECURITY CONFIGURATION
     SECURITY_NON_ROOT_UID=1001
     SECURITY_NON_ROOT_GID=1001
     SECURITY_DROP_CAPABILITIES=ALL
     SECURITY_ADD_CAPABILITIES="SETGID,SETUID,CHOWN"
     SECURITY_NO_NEW_PRIVILEGES=true

     # AUTOMATION CONFIGURATION
     ERROR_RECOVERY_ENABLED=true
     BACKUP_ENABLED=true
     BACKUP_INTERVAL_HOURS=24
     AUTO_INGEST_ON_STARTUP=true

     # VECTORSTORE CONFIGURATION
     VECTORSTORE_TYPE=faiss
     VECTORSTORE_MAX_DOCS=1000000
     VECTORSTORE_SAVE_TIMEOUT_S=30
     VECTORSTORE_INGEST_BATCH_SIZE=100
     VECTORSTORE_VERIFY_ON_LOAD=true

     # DOCKER CONFIGURATION
     COMPOSE_PROJECT_NAME=xnai
     BUILDKIT_INLINE_CACHE=1
     DOCKER_BUILDKIT=1

     # SESSION CONFIGURATION
     SESSION_TIMEOUT_S=3600
     SESSION_MAX_CONCURRENT=10
     SESSION_PERSIST=true

     # PROMETHEUS
     PROMETHEUS_METRICS_ENABLED=true
     PROMETHEUS_PORT=8002
     PROMETHEUS_UPDATE_INTERVAL_S=30
     PROMETHEUS_MULTIPROC_DIR=/prometheus_data

     OFFLINE_BUILD=true