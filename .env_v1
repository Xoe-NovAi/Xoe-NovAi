# ============================================================================
# Xoe-NovAi Phase 1 v0.1.2 - Production Environment Configuration
# ============================================================================
# Purpose: Complete runtime configuration for all services
# Guide Reference: Section 3 (Configuration Management)
# Last Updated: 2025-10-18
# Total Variables: 197 (all CHANGE_ME values filled)
# ============================================================================

# STACK IDENTITY
STACK_NAME=xnai-stack
STACK_VERSION=v0.1.2
COMPOSE_PROJECT_NAME=xnai
APP_UID=1001
APP_GID=1001

# REDIS (7.4.1)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=X7n9mQ4wP2kL8vRt5Hy9Zq3Bn6Km2Wp4
REDIS_TIMEOUT=60
REDIS_MAX_CONNECTIONS=50
REDIS_APPENDONLY=yes
REDIS_APPENDFSYNC=everysec
REDIS_MAXMEMORY=512mb
REDIS_MAXMEMORY_POLICY=allkeys-lru
REDIS_TCP_BACKLOG=2048
REDIS_PROTECTED_MODE=no
REDIS_STREAM_MAX_LEN=1000
REDIS_CACHE_TTL=3600
REDIS_CACHE_PREFIX=xnai_cache
REDIS_CACHE_MAX_KEYS=10000

# THREADING (AMD Ryzen 7 5700U)
LLAMA_CPP_N_THREADS=6
OMP_NUM_THREADS=1
OPENBLAS_NUM_THREADS=1
MKL_NUM_THREADS=1
OPENBLAS_CORETYPE=ZEN
MKL_DEBUG_CPU_TYPE=5
VECLIB_MAXIMUM_THREADS=1

# MEMORY (<6GB target)
LLAMA_CPP_F16_KV=true
LLAMA_CPP_USE_MLOCK=true
LLAMA_CPP_USE_MMAP=true
LLAMA_CPP_N_BATCH=512
LLAMA_CPP_N_CTX=2048
MEMORY_LIMIT_GB=6.0
MEMORY_WARNING_THRESHOLD_GB=5.5
MEMORY_CRITICAL_THRESHOLD_GB=5.8

# LLM
LLM_MODEL_PATH=/models/gemma-3-4b-it-UD-Q5_K_XL.gguf
LLM_MAX_TOKENS=512
LLM_TEMPERATURE=0.7
LLM_TOP_P=0.95
LLM_TOP_K=40
LLM_REPEAT_PENALTY=1.1
LLM_STREAMING=true
LLM_VERBOSE=false

# EMBEDDINGS
EMBEDDING_MODEL_PATH=/embeddings/all-MiniLM-L12-v2.Q8_0.gguf
EMBEDDING_DIMENSIONS=384
EMBEDDING_N_THREADS=2
EMBEDDING_N_CTX=512

# PATHS
FAISS_INDEX_PATH=/app/XNAi_rag_app/faiss_index
FAISS_BACKUP_PATH=/backups
FAISS_BACKUP_RETENTION_DAYS=7
FAISS_BACKUP_MAX_COUNT=5
LIBRARY_PATH=/library
KNOWLEDGE_PATH=/knowledge
LOGS_PATH=/app/XNAi_rag_app/logs
CONFIG_PATH=/app/XNAi_rag_app/config.toml

# API
RAG_API_URL=http://rag:8000
API_HOST=0.0.0.0
API_PORT=8000
API_TIMEOUT_SECONDS=30
API_MAX_BODY_SIZE=100MB
API_RETRY_ATTEMPTS=3
API_RETRY_BACKOFF_FACTOR=2
API_RETRY_MAX_WAIT_S=10
API_CORS_ORIGINS=http://localhost:8001,http://127.0.0.1:8001,http://ui:8001

# UI (Chainlit)
CHAINLIT_HOST=0.0.0.0
CHAINLIT_PORT=8001
CHAINLIT_NO_TELEMETRY=true
CHAINLIT_MAX_FILE_SIZE=100MB
CHAINLIT_THEME=dark

# LOGGING
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_PATH=/app/XNAi_rag_app/logs/xnai.log
LOG_MAX_SIZE=10m
LOG_BACKUP_COUNT=5
LOG_CONSOLE_ENABLED=true
LOG_FILE_ENABLED=true

# ZERO-TELEMETRY (8 disables - ALL REQUIRED)
CHAINLIT_NO_TELEMETRY=true
CRAWL4AI_NO_TELEMETRY=true
LLAMA_CPP_NO_TELEMETRY=true
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
SCARF_NO_ANALYTICS=true

# CRAWLMODULE (NEW rev_1.4)
CRAWL4AI_MAX_DEPTH=2
CRAWL_RATE_LIMIT_PER_MIN=30
CRAWL_SANITIZE_SCRIPTS=true
CRAWL_MAX_ITEMS=50
CRAWL_ALLOWLIST_URLS=*.gutenberg.org,*.arxiv.org,*.nih.gov,*.youtube.com
CRAWL_CACHE_DIR=/app/cache
CRAWL_CACHE_TTL=86400
CRAWL_USER_AGENT=Xoe-NovAi-CrawlModule/0.1.7

# PROMETHEUS
PROMETHEUS_METRICS_ENABLED=true
PROMETHEUS_PORT=8002
PROMETHEUS_UPDATE_INTERVAL_S=30
PROMETHEUS_MULTIPROC_DIR=/prometheus_data

# COMPILER FLAGS
CMAKE_ARGS=-DLLAMA_BLAS=ON -DLLAMA_BLAS_VENDOR=OpenBLAS -DLLAMA_AVX2=ON -DLLAMA_FMA=ON -DLLAMA_F16C=ON
FORCE_CMAKE=1

# HEALTH CHECKS
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=15
HEALTH_CHECK_RETRIES=5
HEALTH_CHECK_START_PERIOD=90
HEALTH_CHECK_COMMAND=python3 /app/XNAi_rag_app/healthcheck.py
HEALTH_TARGETS=llm,embeddings,memory,redis,vectorstore,ryzen,crawler
HEALTH_CHECK_MEMORY_MAX_GB=6.0
HEALTH_CHECK_LLM_TIMEOUT=10
HEALTH_CHECK_REDIS_TIMEOUT=5
HEALTH_CHECK_CRAWLER_TIMEOUT=10

# SECURITY
SECURITY_NON_ROOT_UID=1001
SECURITY_NON_ROOT_GID=1001
SECURITY_DROP_CAPABILITIES=ALL
SECURITY_ADD_CAPABILITIES=SETGID,SETUID,CHOWN
SECURITY_NO_NEW_PRIVILEGES=true

# RAG
RAG_ENABLED=true
RAG_TOP_K=5
RAG_SIMILARITY_THRESHOLD=0.7
RAG_RERANK_RESULTS=true
RAG_PER_DOC_CHARS=500
RAG_TOTAL_CHARS=2048
RAG_CHUNK_SIZE=1000
RAG_CHUNK_OVERLAP=200
RAG_SEARCH_TIMEOUT_S=10

# AUTOMATION